{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\VIVOBOOK\\\\Pictures\\\\studybuddy-lang\\\\frontend\\\\src\\\\components\\\\LessonDetails.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\nimport icon from '../assets/icons/play.png';\nimport Quiz from './Quiz'; // Импортируем компонент Quiz\nimport LessonReviews from './LessonReviews';\nimport './LessonDetails.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction LessonDetails() {\n  _s();\n  const {\n    id\n  } = useParams(); // Получаем ID из URL\n  const [lesson, setLesson] = useState(null); // Хранение данных урока\n  const [loading, setLoading] = useState(true); // Состояние загрузки\n  const [error, setError] = useState(null); // Состояние ошибки\n  const [openWords, setOpenWords] = useState({}); // Состояние для открытых слов\n  const [likes, setLikes] = useState(0); // Количество лайков\n  const [userLiked, setUserLiked] = useState(false); // Проверка, поставил ли пользователь лайк\n  const [currentUserId, setCurrentUserId] = useState(null); // ID текущего пользователя\n  const [user, setUser] = useState(null); // Данные текущего пользователя (если нужны для других операций)\n  const [isEditing, setIsEditing] = useState(false);\n  const [editedLesson, setEditedLesson] = useState(null); // Данные для редактирования\n\n  const [editedTextFragments, setEditedTextFragments] = useState([]);\n  const [editedAudioFiles, setEditedAudioFiles] = useState([]);\n  const [editedVideoFiles, setEditedVideoFiles] = useState([]);\n  const [editedPictures, setEditedPictures] = useState([]);\n  const [editedVocabulary, setEditedVocabulary] = useState([]);\n\n  // Получение ID текущего пользователя\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      const decoded = JSON.parse(atob(token.split('.')[1]));\n      setCurrentUserId(decoded.userId);\n\n      // Получаем данные о текущем пользователе\n      axios.get('http://localhost:5000/users/me', {\n        headers: {\n          Authorization: `${token}`\n        }\n      }).then(response => {\n        setUser(response.data); // Сохраняем данные пользователя\n      }).catch(error => {\n        console.error(\"Ошибка при получении данных пользователя:\", error);\n      });\n    }\n  }, []);\n\n  // Загружаем урок по ID\n  useEffect(() => {\n    const fetchLesson = async () => {\n      try {\n        const response = await axios.get(`http://localhost:5000/lessons/${id}`);\n        setLesson(response.data); // Сохраняем данные урока в состоянии\n        // Устанавливаем количество лайков (если это массив, берём его длину)\n        const likeCount = Array.isArray(response.data.likes) ? response.data.likes.length : response.data.likes || 0;\n        setLikes(likeCount);\n\n        // Проверяем, лайкал ли пользователь (например, через флаг userLiked)\n        setUserLiked(response.data.userLiked || false);\n        setLoading(false);\n\n        // Устанавливаем данные для редактирования\n        setEditedLesson(response.data);\n        setEditedTextFragments(response.data.content.text_fragments || []);\n        setEditedAudioFiles(response.data.content.audio || []);\n        setEditedVideoFiles(response.data.content.video || []);\n        setEditedPictures(response.data.content.pictures || []);\n        setEditedVocabulary(response.data.vocabulary || []);\n      } catch (err) {\n        setError('Не удалось загрузить урок'); // Обработка ошибки\n        setLoading(false);\n      }\n    };\n    fetchLesson();\n  }, [id]); // useEffect будет вызываться при изменении ID в URL\n\n  const handleEditClick = () => {\n    setIsEditing(true);\n    setEditedLesson(lesson); // Заполняем форму редактирования текущими данными\n  };\n  const handleSaveClick = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) return alert('Вы не авторизованы!');\n    try {\n      const updatedLesson = {\n        ...editedLesson,\n        content: {\n          ...editedLesson.content,\n          text_fragments: editedTextFragments,\n          audio: editedAudioFiles,\n          video: editedVideoFiles,\n          pictures: editedPictures\n        },\n        vocabulary: editedVocabulary\n      };\n      await axios.put(`http://localhost:5000/lessons/${id}`, updatedLesson, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setLesson(updatedLesson);\n      setIsEditing(false);\n    } catch (err) {\n      console.error('Ошибка при сохранении изменений:', err);\n      alert('Ошибка при сохранении изменений');\n    }\n  };\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setEditedLesson(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const handleTextFragmentChange = (index, newText) => {\n    const updatedFragments = [...editedTextFragments];\n    updatedFragments[index].text = newText;\n    setEditedTextFragments(updatedFragments);\n  };\n  const handleAudioFileChange = (index, newFile) => {\n    const updatedAudio = [...editedAudioFiles];\n    updatedAudio[index] = newFile;\n    setEditedAudioFiles(updatedAudio);\n  };\n  const handleVideoFileChange = (index, newFile) => {\n    const updatedVideo = [...editedVideoFiles];\n    updatedVideo[index] = newFile;\n    setEditedVideoFiles(updatedVideo);\n  };\n  const handlePictureChange = (index, newFile) => {\n    const updatedPictures = [...editedPictures];\n    updatedPictures[index] = newFile;\n    setEditedPictures(updatedPictures);\n  };\n  const handleVocabularyChange = (index, newWord, newTranslation) => {\n    const updatedVocabulary = [...editedVocabulary];\n    updatedVocabulary[index] = {\n      word: newWord,\n      translation: newTranslation\n    };\n    setEditedVocabulary(updatedVocabulary);\n  };\n  const handleDeleteLesson = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) return alert('Вы не авторизованы!');\n    try {\n      await axios.delete(`http://localhost:5000/lessons/${id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert('Урок успешно удален!');\n    } catch (err) {\n      var _err$response;\n      console.error('Ошибка при удалении урока:', ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err.message);\n      alert('Ошибка при удалении урока');\n    }\n  };\n  const handleLike = async () => {\n    if (userLiked) return;\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        alert('Пожалуйста, войдите в систему!');\n        return;\n      }\n      const response = await axios.post(`http://localhost:5000/lessons/${id}/like`, {}, {\n        headers: {\n          'Authorization': `${token}`\n        }\n      });\n      if (response.data.message === 'Лайк успешно добавлен') {\n        setLikes(response.data.likesCount);\n        setUserLiked(true);\n      }\n    } catch (err) {\n      console.error('Ошибка при добавлении лайка:', err);\n      alert('Ошибка при добавлении лайка');\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 12\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 12\n    }, this);\n  }\n  if (!lesson) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"\\u0423\\u0440\\u043E\\u043A \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 12\n    }, this);\n  }\n  const content = lesson.content || {};\n  const textFragments = content.text_fragments || [];\n  const audioFiles = content.audio || [];\n  const videoFiles = content.video || [];\n  const pictures = content.pictures || [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"lesson-details\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"lesson-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"centered-header\",\n        children: lesson.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: lesson.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), lesson.createdBy === currentUserId && !isEditing && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleEditClick,\n        className: \"edit-btn\",\n        children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 11\n      }, this), isEditing && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSaveClick,\n          className: \"save-btn\",\n          children: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C \\u0438\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"centered-header\",\n        children: \"\\u0421\\u043E\\u0434\\u0435\\u0440\\u0436\\u0430\\u043D\\u0438\\u0435 \\u0443\\u0440\\u043E\\u043A\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0422\\u0435\\u043A\\u0441\\u0442\\u043E\\u0432\\u044B\\u0435 \\u0444\\u0440\\u0430\\u0433\\u043C\\u0435\\u043D\\u0442\\u044B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this), textFragments.length > 0 ? /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"text-fragments-list\",\n        children: editedTextFragments.map((item, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"text-fragment-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: item.text,\n              onChange: e => handleTextFragmentChange(index, e.target.value),\n              disabled: !isEditing,\n              className: \"text-fragment-textarea\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"em\", {\n            children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: item.translation,\n              onChange: e => handleTextFragmentChange(index, e.target.value),\n              disabled: !isEditing,\n              className: \"text-fragment-textarea\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u041D\\u0435\\u0442 \\u0442\\u0435\\u043A\\u0441\\u0442\\u043E\\u0432\\u044B\\u0445 \\u0444\\u0440\\u0430\\u0433\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0410\\u0443\\u0434\\u0438\\u043E\\u0444\\u0430\\u0439\\u043B\\u044B \\u0434\\u043B\\u044F \\u0442\\u0440\\u0435\\u043D\\u0438\\u0440\\u043E\\u0432\\u043A\\u0438 \\u043D\\u0430\\u0441\\u043B\\u044B\\u0448\\u0430\\u043D\\u043D\\u043E\\u0441\\u0442\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), audioFiles.length > 0 ? audioFiles.map((audio, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"audio-file\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: audio.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n          controls: true,\n          children: [/*#__PURE__*/_jsxDEV(\"source\", {\n            src: `http://localhost:5000/${audio.file}`,\n            type: \"audio/mpeg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 17\n          }, this), \"\\u0412\\u0430\\u0448 \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440 \\u043D\\u0435 \\u043F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0438\\u0432\\u0430\\u0435\\u0442 \\u0430\\u0443\\u0434\\u0438\\u043E.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 15\n        }, this), isEditing && /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: e => handleAudioFileChange(index, e.target.files[0]),\n          className: \"file-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 17\n        }, this)]\n      }, audio._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 13\n      }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u041D\\u0435\\u0442 \\u0430\\u0443\\u0434\\u0438\\u043E\\u0444\\u0430\\u0439\\u043B\\u043E\\u0432.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0412\\u0438\\u0434\\u0435\\u043E\\u0440\\u043E\\u043B\\u0438\\u043A\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 9\n      }, this), videoFiles.length > 0 ? videoFiles.map((video, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-file\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: video.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          width: \"100%\",\n          controls: true,\n          children: [/*#__PURE__*/_jsxDEV(\"source\", {\n            src: `http://localhost:5000/${video.file}`,\n            type: \"video/mp4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 17\n          }, this), \"\\u0412\\u0430\\u0448 \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440 \\u043D\\u0435 \\u043F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0438\\u0432\\u0430\\u0435\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 15\n        }, this), isEditing && /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: e => handleVideoFileChange(index, e.target.files[0]),\n          className: \"file-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 17\n        }, this)]\n      }, video._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 13\n      }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u041D\\u0435\\u0442 \\u0432\\u0438\\u0434\\u0435\\u043E\\u0440\\u043E\\u043B\\u0438\\u043A\\u043E\\u0432.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0424\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 9\n      }, this), pictures.length > 0 ? pictures.map((picture, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"picture-file\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: picture.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: `http://localhost:5000/${picture.file}`,\n          alt: picture.description,\n          className: \"lesson-picture\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 15\n        }, this), isEditing && /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: e => handlePictureChange(index, e.target.files[0]),\n          className: \"file-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 17\n        }, this)]\n      }, picture._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 13\n      }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u041D\\u0435\\u0442 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0439.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0412\\u0430\\u0448\\u0438 \\u043D\\u043E\\u0432\\u044B\\u0435 \\u0441\\u043B\\u043E\\u0432\\u0430 \\u0437\\u0430 \\u0443\\u0440\\u043E\\u043A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"vocabulary-list\",\n        children: editedVocabulary.length > 0 ? editedVocabulary.map((item, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"vocabulary-item\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"vocabulary-item-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              value: item.word,\n              onChange: e => handleVocabularyChange(index, e.target.value, item.translation),\n              disabled: !isEditing,\n              className: \"vocabulary-input\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              value: item.translation,\n              onChange: e => handleVocabularyChange(index, item.word, e.target.value),\n              disabled: !isEditing,\n              className: \"vocabulary-input\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 17\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 15\n        }, this)) : /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"\\u041D\\u0435\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043E \\u0441\\u043B\\u043E\\u0432\\u0430\\u0445\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this), lesson.quiz && lesson.quiz.length > 0 && /*#__PURE__*/_jsxDEV(Quiz, {\n        quizData: lesson.quiz\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 51\n      }, this), /*#__PURE__*/_jsxDEV(LessonReviews, {\n        lessonId: id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), lesson && lesson.createdBy === currentUserId && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleDeleteLesson,\n        className: \"delete-btn\",\n        children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0443\\u0440\\u043E\\u043A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 210,\n    columnNumber: 5\n  }, this);\n}\n_s(LessonDetails, \"7d8qBHHY+uxN4jGubwVZXh8DB14=\", false, function () {\n  return [useParams];\n});\n_c = LessonDetails;\nexport default LessonDetails;\nvar _c;\n$RefreshReg$(_c, \"LessonDetails\");","map":{"version":3,"names":["React","useEffect","useState","axios","useParams","icon","Quiz","LessonReviews","jsxDEV","_jsxDEV","LessonDetails","_s","id","lesson","setLesson","loading","setLoading","error","setError","openWords","setOpenWords","likes","setLikes","userLiked","setUserLiked","currentUserId","setCurrentUserId","user","setUser","isEditing","setIsEditing","editedLesson","setEditedLesson","editedTextFragments","setEditedTextFragments","editedAudioFiles","setEditedAudioFiles","editedVideoFiles","setEditedVideoFiles","editedPictures","setEditedPictures","editedVocabulary","setEditedVocabulary","token","localStorage","getItem","decoded","JSON","parse","atob","split","userId","get","headers","Authorization","then","response","data","catch","console","fetchLesson","likeCount","Array","isArray","length","content","text_fragments","audio","video","pictures","vocabulary","err","handleEditClick","handleSaveClick","alert","updatedLesson","put","handleInputChange","e","name","value","target","prev","handleTextFragmentChange","index","newText","updatedFragments","text","handleAudioFileChange","newFile","updatedAudio","handleVideoFileChange","updatedVideo","handlePictureChange","updatedPictures","handleVocabularyChange","newWord","newTranslation","updatedVocabulary","word","translation","handleDeleteLesson","delete","_err$response","message","handleLike","post","likesCount","children","fileName","_jsxFileName","lineNumber","columnNumber","textFragments","audioFiles","videoFiles","className","title","description","createdBy","onClick","map","item","onChange","disabled","controls","src","file","type","files","_id","width","picture","alt","quiz","quizData","lessonId","_c","$RefreshReg$"],"sources":["C:/Users/VIVOBOOK/Pictures/studybuddy-lang/frontend/src/components/LessonDetails.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useParams } from 'react-router-dom';\r\nimport icon from '../assets/icons/play.png';\r\nimport Quiz from './Quiz'; // Импортируем компонент Quiz\r\nimport LessonReviews from './LessonReviews'; \r\nimport './LessonDetails.css';\r\n\r\nfunction LessonDetails() {\r\n  const { id } = useParams(); // Получаем ID из URL\r\n  const [lesson, setLesson] = useState(null); // Хранение данных урока\r\n  const [loading, setLoading] = useState(true); // Состояние загрузки\r\n  const [error, setError] = useState(null); // Состояние ошибки\r\n  const [openWords, setOpenWords] = useState({}); // Состояние для открытых слов\r\n  const [likes, setLikes] = useState(0); // Количество лайков\r\n  const [userLiked, setUserLiked] = useState(false); // Проверка, поставил ли пользователь лайк\r\n  const [currentUserId, setCurrentUserId] = useState(null); // ID текущего пользователя\r\n  const [user, setUser] = useState(null); // Данные текущего пользователя (если нужны для других операций)\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editedLesson, setEditedLesson] = useState(null); // Данные для редактирования\r\n\r\n  const [editedTextFragments, setEditedTextFragments] = useState([]);\r\n  const [editedAudioFiles, setEditedAudioFiles] = useState([]);\r\n  const [editedVideoFiles, setEditedVideoFiles] = useState([]);\r\n  const [editedPictures, setEditedPictures] = useState([]);\r\n  const [editedVocabulary, setEditedVocabulary] = useState([]);\r\n\r\n  // Получение ID текущего пользователя\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      const decoded = JSON.parse(atob(token.split('.')[1]));\r\n      setCurrentUserId(decoded.userId);\r\n      \r\n      // Получаем данные о текущем пользователе\r\n      axios.get('http://localhost:5000/users/me', {\r\n        headers: { Authorization: `${token}` },\r\n      })\r\n      .then((response) => {\r\n        setUser(response.data); // Сохраняем данные пользователя\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Ошибка при получении данных пользователя:\", error);\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  // Загружаем урок по ID\r\n  useEffect(() => {\r\n    const fetchLesson = async () => {\r\n      try {\r\n        const response = await axios.get(`http://localhost:5000/lessons/${id}`);\r\n        setLesson(response.data); // Сохраняем данные урока в состоянии\r\n        // Устанавливаем количество лайков (если это массив, берём его длину)\r\n        const likeCount = Array.isArray(response.data.likes) ? response.data.likes.length : response.data.likes || 0;\r\n        setLikes(likeCount);\r\n\r\n        // Проверяем, лайкал ли пользователь (например, через флаг userLiked)\r\n        setUserLiked(response.data.userLiked || false);\r\n        setLoading(false);\r\n\r\n         // Устанавливаем данные для редактирования\r\n         setEditedLesson(response.data);\r\n         setEditedTextFragments(response.data.content.text_fragments || []);\r\n         setEditedAudioFiles(response.data.content.audio || []);\r\n         setEditedVideoFiles(response.data.content.video || []);\r\n         setEditedPictures(response.data.content.pictures || []);\r\n         setEditedVocabulary(response.data.vocabulary || []);\r\n      } catch (err) {\r\n        setError('Не удалось загрузить урок'); // Обработка ошибки\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchLesson();\r\n  }, [id]); // useEffect будет вызываться при изменении ID в URL\r\n\r\n  const handleEditClick = () => {\r\n    setIsEditing(true);\r\n    setEditedLesson(lesson); // Заполняем форму редактирования текущими данными\r\n  };\r\n\r\n  const handleSaveClick = async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return alert('Вы не авторизованы!');\r\n\r\n    try {\r\n      const updatedLesson = {\r\n        ...editedLesson,\r\n        content: {\r\n          ...editedLesson.content,\r\n          text_fragments: editedTextFragments,\r\n          audio: editedAudioFiles,\r\n          video: editedVideoFiles,\r\n          pictures: editedPictures,\r\n        },\r\n        vocabulary: editedVocabulary,\r\n      };\r\n\r\n      await axios.put(`http://localhost:5000/lessons/${id}`, updatedLesson, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      setLesson(updatedLesson);\r\n      setIsEditing(false);\r\n    } catch (err) {\r\n      console.error('Ошибка при сохранении изменений:', err);\r\n      alert('Ошибка при сохранении изменений');\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setEditedLesson((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const handleTextFragmentChange = (index, newText) => {\r\n    const updatedFragments = [...editedTextFragments];\r\n    updatedFragments[index].text = newText;\r\n    setEditedTextFragments(updatedFragments);\r\n  };\r\n\r\n  const handleAudioFileChange = (index, newFile) => {\r\n    const updatedAudio = [...editedAudioFiles];\r\n    updatedAudio[index] = newFile;\r\n    setEditedAudioFiles(updatedAudio);\r\n  };\r\n\r\n  const handleVideoFileChange = (index, newFile) => {\r\n    const updatedVideo = [...editedVideoFiles];\r\n    updatedVideo[index] = newFile;\r\n    setEditedVideoFiles(updatedVideo);\r\n  };\r\n\r\n  const handlePictureChange = (index, newFile) => {\r\n    const updatedPictures = [...editedPictures];\r\n    updatedPictures[index] = newFile;\r\n    setEditedPictures(updatedPictures);\r\n  };\r\n\r\n  const handleVocabularyChange = (index, newWord, newTranslation) => {\r\n    const updatedVocabulary = [...editedVocabulary];\r\n    updatedVocabulary[index] = { word: newWord, translation: newTranslation };\r\n    setEditedVocabulary(updatedVocabulary);\r\n  };\r\n\r\n  const handleDeleteLesson = async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return alert('Вы не авторизованы!');\r\n\r\n    try {\r\n      await axios.delete(`http://localhost:5000/lessons/${id}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      alert('Урок успешно удален!');\r\n    } catch (err) {\r\n      console.error('Ошибка при удалении урока:', err.response?.data || err.message);\r\n      alert('Ошибка при удалении урока');\r\n    }\r\n  };\r\n\r\n  const handleLike = async () => {\r\n    if (userLiked) return;\r\n\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        alert('Пожалуйста, войдите в систему!');\r\n        return;\r\n      }\r\n\r\n      const response = await axios.post(`http://localhost:5000/lessons/${id}/like`, {}, {\r\n        headers: { 'Authorization': `${token}` },\r\n      });\r\n\r\n      if (response.data.message === 'Лайк успешно добавлен') {\r\n        setLikes(response.data.likesCount);\r\n        setUserLiked(true);\r\n      }\r\n    } catch (err) {\r\n      console.error('Ошибка при добавлении лайка:', err);\r\n      alert('Ошибка при добавлении лайка');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>Загрузка...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div>{error}</div>;\r\n  }\r\n\r\n  if (!lesson) {\r\n    return <div>Урок не найден.</div>;\r\n  }\r\n\r\n  const content = lesson.content || {};\r\n  const textFragments = content.text_fragments || [];\r\n  const audioFiles = content.audio || [];\r\n  const videoFiles = content.video || [];\r\n  const pictures = content.pictures || [];\r\n\r\n  return (\r\n    <div className=\"lesson-details\">\r\n      <div className=\"lesson-form\">\r\n        <h1 className=\"centered-header\">{lesson.title}</h1>\r\n        <p>{lesson.description}</p>\r\n        {lesson.createdBy === currentUserId && !isEditing && (\r\n          <button onClick={handleEditClick} className=\"edit-btn\">Редактировать</button>\r\n        )}\r\n        {isEditing && (\r\n          <div>\r\n            <button onClick={handleSaveClick} className=\"save-btn\">Сохранить изменения</button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Содержание урока */}\r\n        <h2 className=\"centered-header\">Содержание урока</h2>\r\n\r\n        {/* Текстовые фрагменты с возможностью редактирования */}\r\n        <h3>Текстовые фрагменты</h3>\r\n        {textFragments.length > 0 ? (\r\n          <ul className=\"text-fragments-list\">\r\n            {editedTextFragments.map((item, index) => (\r\n              <li key={index} className=\"text-fragment-item\">\r\n                <strong>\r\n                  <textarea\r\n                    value={item.text}\r\n                    onChange={(e) => handleTextFragmentChange(index, e.target.value)}\r\n                    disabled={!isEditing}\r\n                    className=\"text-fragment-textarea\"\r\n                  />\r\n                </strong>\r\n                <br />\r\n                <em>\r\n                  <textarea\r\n                    value={item.translation}\r\n                    onChange={(e) => handleTextFragmentChange(index, e.target.value)}\r\n                    disabled={!isEditing}\r\n                    className=\"text-fragment-textarea\"\r\n                  />\r\n                </em>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        ) : (\r\n          <p>Нет текстовых фрагментов.</p>\r\n        )}\r\n\r\n        {/* Аудиофайлы */}\r\n        <h3>Аудиофайлы для тренировки наслышанности</h3>\r\n        {audioFiles.length > 0 ? (\r\n          audioFiles.map((audio, index) => (\r\n            <div key={audio._id} className=\"audio-file\">\r\n              <p>{audio.description}</p>\r\n              <audio controls>\r\n                <source src={`http://localhost:5000/${audio.file}`} type=\"audio/mpeg\" />\r\n                Ваш браузер не поддерживает аудио.\r\n              </audio>\r\n              {isEditing && (\r\n                <input type=\"file\" onChange={(e) => handleAudioFileChange(index, e.target.files[0])} className=\"file-input\" />\r\n              )}\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <p>Нет аудиофайлов.</p>\r\n        )}\r\n\r\n        {/* Видеофайлы */}\r\n        <h3>Видеоролики</h3>\r\n        {videoFiles.length > 0 ? (\r\n          videoFiles.map((video, index) => (\r\n            <div key={video._id} className=\"video-file\">\r\n              <p>{video.description}</p>\r\n              <video width=\"100%\" controls>\r\n                <source src={`http://localhost:5000/${video.file}`} type=\"video/mp4\" />\r\n                Ваш браузер не поддерживает видео.\r\n              </video>\r\n              {isEditing && (\r\n                <input type=\"file\" onChange={(e) => handleVideoFileChange(index, e.target.files[0])} className=\"file-input\" />\r\n              )}\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <p>Нет видеороликов.</p>\r\n        )}\r\n\r\n        {/* Фотографии */}\r\n        <h3>Фотографии</h3>\r\n        {pictures.length > 0 ? (\r\n          pictures.map((picture, index) => (\r\n            <div key={picture._id} className=\"picture-file\">\r\n              <p>{picture.description}</p>\r\n              <img\r\n                src={`http://localhost:5000/${picture.file}`}\r\n                alt={picture.description}\r\n                className=\"lesson-picture\"\r\n              />\r\n              {isEditing && (\r\n                <input type=\"file\" onChange={(e) => handlePictureChange(index, e.target.files[0])} className=\"file-input\" />\r\n              )}\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <p>Нет изображений.</p>\r\n        )}\r\n\r\n        {/* Словарь */}\r\n        <h3>Ваши новые слова за урок</h3>\r\n        <ul className=\"vocabulary-list\">\r\n          {editedVocabulary.length > 0 ? (\r\n            editedVocabulary.map((item, index) => (\r\n              <li key={index} className=\"vocabulary-item\">\r\n                <div\r\n                  className=\"vocabulary-item-content\"\r\n                >\r\n                  <input\r\n                    value={item.word}\r\n                    onChange={(e) => handleVocabularyChange(index, e.target.value, item.translation)}\r\n                    disabled={!isEditing}\r\n                    className=\"vocabulary-input\"\r\n                  />\r\n                  <input\r\n                    value={item.translation}\r\n                    onChange={(e) => handleVocabularyChange(index, item.word, e.target.value)}\r\n                    disabled={!isEditing}\r\n                    className=\"vocabulary-input\"\r\n                  />\r\n                </div>\r\n              </li>\r\n            ))\r\n          ) : (\r\n            <li>Нет данных о словах</li>\r\n          )}\r\n        </ul>\r\n\r\n        {/* Вставка компонента Quiz */}\r\n        {lesson.quiz && lesson.quiz.length > 0 && <Quiz quizData={lesson.quiz} />}\r\n\r\n        <LessonReviews lessonId={id} />\r\n        {lesson && lesson.createdBy === currentUserId && (\r\n          <button onClick={handleDeleteLesson} className=\"delete-btn\">Удалить урок</button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LessonDetails;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}